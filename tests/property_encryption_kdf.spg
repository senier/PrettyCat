<?xml version="1.0"?>
<spg>

    <input id="Input" integrity="false" confidentiality="true">
        <description>
            Confidential input
        </description>
        <flow sarg="data" sink="Encrypt" darg="plaintext">
            <assert confidentiality="true">
                Plaintext is confidential.
            </assert>
        </flow>
    </input>

    <input id="IV">
        <description>
            Static IV
        </description>
        <flow sarg="const" sink="Encrypt" darg="ctr"/>
    </input>

    <input id="Random" integrity="true" confidentiality="true">
        <description>
            Generate random key
        </description>
        <flow sarg="data" sink="KDF" darg="random">
            <assert confidentiality="true">
                Secret key.
            </assert>
        </flow>
    </input>

    <xform id="KDF">
        <description>
            Key derivation
        </description>
        <flow sarg="const#1" sink="Encrypt" darg="key">
            <assert confidentiality="true">
                Secret key.
            </assert>
        </flow>
        <arg name="random"/>
    </xform>

    <encrypt id="Encrypt">
        <description>
            Symmetric counter mode encryption
        </description>
        <flow sarg="ciphertext" sink="Output" darg="data"/>
    </encrypt>

    <output id="Output" integrity="false" confidentiality="false">
        <description>
            Send out encrypted protected message
        </description>
        <arg name="data"/>
    </output>
</spg>

