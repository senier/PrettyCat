<!doctype html>
<html>
<head>
  <title>Network | Basic usage</title>
  <meta charset="UTF-8"> 
  <script type="text/javascript" src="include/vis.min.js"></script>
  <link href="../../../dist/vis.css" rel="stylesheet" type="text/css" />

  <style type="text/css">
	#spgnetwork {
      width: 100%;
      height: 100%;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border: 1px solid lightgray;
    }
  </style>
</head>
<body>

<p>
  Create a simple network with some nodes and edges.
</p>

<div id="spgnetwork"></div>

<script type="text/javascript">

    function loadFile(file, callback) {   
        var xobj = new XMLHttpRequest();
        xobj.overrideMimeType("application/json");
        xobj.open('GET', file, true);
        xobj.onreadystatechange = function () {
            if (xobj.readyState == 4 && xobj.status == "200") {
                callback (xobj.responseText);
            }
        };
        xobj.send(null);  
    }

    var networkOptions = {
    }

    var parserOptions = {
        edges: {
            inheritColors: false
        },
        nodes: {
            parseColor: false
        }
    }

    loadFile('./otr.json', function (input) {
        json = JSON.parse (input);

        var data = vis.network.convertGephi (json, parserOptions);

        // create a network
        var container = document.getElementById('spgnetwork');
        var network = new vis.Network(container, data, networkOptions);

        var partitions = new Set();
        for (var i = 0; i < json.nodes.length; i++){
            partitions.add (json.nodes[i].partition);
        }

        var options = {};
        for (var i = 0; i < json.nodes.length; i++){
            options[json.nodes[i].id] = json.nodes[i].partition;
        }

        for (let p of partitions) {
            var partid = 'partition_' + p;
            var clusterOptionsByData = {
                joinCondition: function (childOptions) {
                    return options[childOptions.id] == p;
                },
                clusterNodeProperties: {id: partid, shape: 'box', size: 40} 
            }
            network.cluster (clusterOptionsByData)
        }
    });

</script>

</body>
</html>
