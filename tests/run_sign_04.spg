<?xml version="1.0"?>
<spg code="testlib">

    <const id="Public key">
        <description>
            Public DSA key
        </description>
        <config hexbytes="00000000008080000000000000050374cab7f3cbf7c8e62dcd2660223605e1345075ee3f2d8d3dc596af0baa8b524c641ebf18ebe97c8de94c752541b642c358e1c8ef1d9c240eadc03cb95ce93ae4ab8714ee508f967a0c50e9c860c8ef02487ff2708759f22e8a24386768d043f09ba677e9b7c01f1085d2c1edbe9097439984eb6c4420ed00000014f805a53bec9c5ef25844b153a4429efad3a4d2b9000000806a0d26c388a10f6da66228fd8f763312ede510e15e45b5a6f21a2cd93bac428470138789502ee715a961efa83c5e99030eb1d1ae3c28759590e1c6283dde0f728b626cd967df5f377ad11aa8c88dd33ce86e1c5bad0a397754d7a1462cb46daa397987e73ebbc6dd442e89283679a8132e445056e50c26ee50bf45798d8b85100000008011e051c366d80b93607d9dc8bd1d92ef2c22f574ebcacf3c314b533f830d5c079d77501e85b88e7ffd2152689067f638bca9436fff3173d162401c8888d301841ea7bda1f2a1afa6c170f27ce1644c8d7ada8cf88cfac7e9f82326d25114f053901e0ae401fe3fb4b550b01e54ee8bda722593ce19fc242816cd409efe8f90ab"/>
        <flow sarg="const" sink="Branch public key" darg="data"/>
    </const>

    <xform id="Branch public key" code="branch">
        <description>
            Branch public key to sign/verify
        </description>
        <flow sarg="data#1" sink="Sign" darg="pubkey"/>
        <flow sarg="data#2" sink="Verify sig" darg="pubkey"/>
        <arg name="data"/>
    </xform>

    <env id="Private key" code='const'>
        <description>
            Private DSA key
        </description>
        <config hexbytes="128ef01d97e4ca1004276693c12cde058cd32eb2"/>
        <flow sarg="data" sink="Sign" darg="privkey"/>
    </env>

    <const id="Message">
        <description>
            Input message
        </description>
        <config hexbytes="f7ff9e8b7bb2e09b70935a5d785e0cc5d9d0abf0"/>
        <flow sarg="const" sink="Branch message" darg="data"/>
    </const>

    <xform id="Branch message" code="branch">
        <description>
            Branch message for sign/verify components
        </description>
        <flow sarg="data#1" sink="Sign" darg="msg"/>
        <flow sarg="data#2" sink="Verify sig" darg="msg"/>
        <arg name="data"/>
    </xform>

    <env id="K" code="const">
        <description>
            "Random" K - Only for testing. Normally this must be
            a random number between [1, q-1] for which the attacker
            does not know the value of any bit.
        </description>
        <config hexbytes="ff"/>
        <flow sarg="data" sink="Sign" darg="rand"/>
    </env>

    <sign id="Sign">
        <description>
            Sign message
        </description>
        <flow sarg="auth" sink="Verify sig" darg="auth"/>
    </sign>


    <env id="Verify sig" code="verify_sig_ext" confidentiality="true">
        <description>
            Compare generated signature using external tool
        </description>
        <arg name="pubkey"/>
        <arg name="auth"/>
        <arg name="msg"/>
    </env>

</spg>
